# CliFx Demo Project

Sample command line interface for managing a library of books.

This demo project shows basic CliFx functionality such as command routing, argument parsing, autogenerated help text, and some other things.

You can get a list of available commands by running `CliFx.Demo --help`.

## Command Auto-completion

### Powershell

* Find the .ps1 file referred to by the $PROFILE variable
* Add the following snippet to that file.

```powershell
$scriptblock = {
    param($wordToComplete, $commandAst, $cursorPosition)
        # note -- if your command is on the path, you should set $command to "CliFx.Demo".
        $command = "CliFx.Demo"

        # Hack: instead of trying to work around Powershell escape shennidgans, set the $commandAst 
        # to a temporary environment variable scoped to this shell only.
        $commandCacheId = "clifx-suggest-" + (new-guid).ToString()
        Set-Content -path "ENV:\$commandCacheId" -value $commandAst

        $result = &$command `[suggest`] --envvar $commandCacheId --cursor $cursorPosition | ForEach-Object {
            [System.Management.Automation.CompletionResult]::new($_, $_, 'ParameterValue', $_)
        }
        
        Remove-Item -Path "ENV:\$commandCacheId"
        $result
}

Register-ArgumentCompleter -Native -CommandName CliFx.Demo -ScriptBlock $scriptblock
```

### Bash 

Add the following snippet to ~/.bashrc

``` bash

# bash parameter completion for the CliFx.Demo CLI
_CliFx_Demo_bash_complete()
{
  local word=${COMP_WORDS[COMP_CWORD]}

  # generate unique environment variable
  CLIFX_CMD_CACHE="clifx-suggest-$(uuidgen)"
  # replace hyphens with underscores to make it valid
  CLIFX_CMD_CACHE=${CLIFX_CMD_CACHE//\-/_}

  export $CLIFX_CMD_CACHE=${COMP_LINE}

  local completions
  completions="$(CliFx.Demo "[suggest]" --cursor "${COMP_POINT}" --envvar $CLIFX_CMD_CACHE 2>/dev/null)"
  if [ $? -ne 0 ]; then
    completions=""
  fi

  unset $CLIFX_CMD_CACHE

  COMPREPLY=( $(compgen -W "$completions" -- "$word") )
}

complete -f -F _CliFx_Demo_bash_complete CliFx.Demo

```



